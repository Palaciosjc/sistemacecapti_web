<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>{% block title %}CECAPTI Web{% endblock %}</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
  </head>
  <body>
    <header class="main-header p-0 mb-4">
      <div
        class="header-gradient w-100 py-3 px-4 d-flex justify-content-between align-items-center"
      >
        <div class="d-flex align-items-center">
          <img
            src="{{ url_for('static', filename='img/logocecapti.jpg') }}"
            alt="Logo CECAPTI"
            style="
              height: 54px;
              width: auto;
              background: #fff;
              border-radius: 8px;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
              margin-right: 18px;
              padding: 4px 8px;
            "
          />
          <h1 class="h3 m-0 fw-bold" style="color: #222; letter-spacing: 1px">
            CECAPTI Web
          </h1>
        </div>
        <nav>
          {% if current_user.is_authenticated %}
          <a
            href="{{ url_for('auth.logout') }}"
            class="btn btn-outline-dark fw-bold"
            >Logout</a
          >
          {% else %}
          <a
            href="{{ url_for('auth.login') }}"
            class="btn btn-outline-dark fw-bold"
            >Login</a
          >
          {% endif %}
        </nav>
      </div>
    </header>
    <div class="d-flex" style="min-height: 80vh">
      <!-- Sidebar -->
      <nav
        class="bg-light border-end p-3"
        style="width: 220px; min-height: 100%"
      >
        <ul class="nav flex-column">
          <li class="nav-item mb-2">
            <a
              class="nav-link {% if request.path == url_for('main.dashboard') %}active fw-bold{% endif %}"
              href="{{ url_for('main.dashboard') }}"
              >Dashboard</a
            >
          </li>
          {% if current_user.is_authenticated %} {% if
          current_user.rol.nombre_rol|lower == 'administrador' %}
          <li class="nav-item mb-2">
            <a
              class="nav-link {% if request.path.startswith('/admin/users') %}active fw-bold{% endif %}"
              href="{{ url_for('main.admin_users') }}"
              >Gestionar Usuarios</a
            >
          </li>
          <li class="nav-item mb-2">
            <a
              class="nav-link {% if request.path.startswith('/admin/courses') %}active fw-bold{% endif %}"
              href="{{ url_for('main.admin_courses') }}"
              >Gestionar Cursos</a
            >
          </li>
          <li class="nav-item mb-2">
            <a
              class="nav-link {% if request.path.startswith('/admin/machinery') %}active fw-bold{% endif %}"
              href="{{ url_for('main.admin_machinery') }}"
              >Gestionar Maquinaria</a
            >
          </li>
          {% elif current_user.rol.nombre_rol|lower == 'instructor' %}
          <li class="nav-item mb-2">
            <a
              class="nav-link {% if request.path == url_for('main.dashboard') %}active fw-bold{% endif %}"
              href="{{ url_for('main.dashboard') }}"
              >Mis Cursos</a
            >
          </li>
          {% elif current_user.rol.nombre_rol|lower == 'alumno' %}
          <li class="nav-item mb-2">
            <a
              class="nav-link {% if request.path == url_for('main.dashboard') %}active fw-bold{% endif %}"
              href="{{ url_for('main.dashboard') }}"
              >Mis Calificaciones</a
            >
          </li>
          {% endif %} {% endif %}
        </ul>
      </nav>
      <!-- Main Content -->
      <main class="flex-grow-1 p-4">
        {% with messages = get_flashed_messages(with_categories=true) %} {% if
        messages %} {% for category, message in messages %}
        <div
          class="alert alert-{{ category }} alert-dismissible fade show"
          role="alert"
        >
          {{ message }}
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="alert"
            aria-label="Close"
          ></button>
        </div>
        {% endfor %} {% endif %} {% endwith %} {% block content %}{% endblock %}
      </main>
    </div>
    <footer class="bg-light text-center py-3 mt-5 border-top">
      <div class="container">
        <span class="text-muted"
          >Â© 2025 CECAPTI-PERU. Todos los derechos reservados.</span
        >
      </div>
    </footer>
    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </body>
</html>
